FROM gradle:jdk17-alpine
WORKDIR /service
COPY . .

ARG EXTERNAL_SERVICE_URL
ARG WIREMOCK_URL
ARG WIREMOCK_PORT
ENV EXTERNAL_SERVICE_URL=$EXTERNAL_SERVICE_URL
ENV WIREMOCK_URL=$WIREMOCK_URL
ENV WIREMOCK_PORT=$WIREMOCK_PORT

RUN ./gradlew build -x test
CMD ./gradlew test